\# Техническое задание: обновление glavtrubtorg.ru (Flask)



\## 1. Цель

Сделать новый сайт glavtrubtorg.ru на Python (Flask), улучшить дизайн и SEO, добавить админку, расширить каталог до 4 уровней (добавить уровень «типоразмер»), сохранить функциональные разделы и позиции в поиске.



Критически важно: старые URL должны работать через 301 редирект на новые (для каталога меняется схема URL).



\## 2. Технологии и запуск

\- Python 3.x

\- Flask + Jinja2

\- SQLite + миграции (Flask-Migrate/Alembic)

\- Запуск: `python app.py`

\- Статика: `/static`

\- Шаблоны: `/templates`

\- Настройки: `config.py` + `.env`

\- README.md обязателен



\## 3. Публичные разделы и URL

Сохраняем существующие разделы и URL:

\- `/` главная

\- `/about/`

\- `/services/`

\- `/price/`

\- `/documentation/`

\- `/contacts/`

\- `/news/` (и `/news/<slug>/`)

\- `/catalog/` — страница входа в продукцию (оставить)



\### 3.1 НОВАЯ схема URL каталога (без /catalog/ в глубине)

Каталог (уровни 2–4) переезжает в корень:



\- Категория: `/<category\_slug>/`

\- Линейка: `/<category\_slug>/<product\_slug>/`

\- Типоразмер: `/<category\_slug>/<product\_slug>/<size\_slug>/`



Пример:

\- `/izoprofleks\_kasafleks/`

\- `/izoprofleks\_kasafleks/izoprofleks\_95a/`

\- `/izoprofleks\_kasafleks/izoprofleks\_75a/40\_75/`



Стандарт: везде завершающий слеш.



\### 3.2 Старые URL каталога (обязательные 301)

Старые URL с префиксом `/catalog/...` обязаны 301 редиректить на новые:

\- `/catalog/<category\_slug>/` -> `/<category\_slug>/`

\- `/catalog/<category\_slug>/<product\_slug>/` -> `/<category\_slug>/<product\_slug>/`

\- `/catalog/<category\_slug>/<product\_slug>/<size\_slug>/` -> `/<category\_slug>/<product\_slug>/<size\_slug>/`



Требования:

\- Только 301, без цепочек.

\- Все внутренние ссылки сайта ведут на новые URL.

\- Canonical на новых страницах — на новый URL.



\## 4. SEO-описание каждой страницы (обязательное)

Для каждой страницы (включая категории/линейки/типоразмеры/новости/статические) хранить и редактировать:

\- SEO Title

\- SEO Description

\- H1

\- SEO текст (HTML)

\- Canonical (авто, без ручного ввода в большинстве случаев)



Автогенерация: если поле пустое, формировать по шаблону.



\## 5. Главное меню (управляется через админку)

Порядок:

1\) О компании

2\) Новости

3\) Продукция

4\) Услуги

5\) Цены

6\) Документация

7\) Контакты



Меню в админке: название, порядок, активность, ссылка, внешняя ссылка, nofollow, target\_blank.



\## 6. Каталог 4 уровня

Уровень 1: `/catalog/` — плитки категорий (брендов).

Уровень 2: категория `/<category\_slug>/` — H1, описание, картинка, список линеек.

Уровень 3: линейка `/<category\_slug>/<product\_slug>/` — описание, картинка, таблица типоразмеров.

Уровень 4: типоразмер `/<category\_slug>/<product\_slug>/<size\_slug>/` — карточка товара.



Типоразмер:

\- full\_name

\- size\_text (например 40/75)

\- size\_slug (например 40\_75)

\- price, currency

\- sku

\- availability (in\_stock bool)

\- unit (ед.изм.)

\- image

\- breadcrumbs



\## 7. Микроразметка товара

На каждой странице типоразмера автоматически генерировать JSON-LD:

\- schema.org Product

\- offers.price, offers.priceCurrency, offers.availability, offers.url

\- sku, brand, name, image, description



\## 8. Новости

\- `/news/` список

\- `/news/<slug>/` страница новости

\- блок последних новостей на главной

\- в админке CRUD + CSV импорт



\## 9. Админка (обязательно)

\- Авторизация (логин/пароль), хеш пароля

Разделы:

1\) Страницы

2\) Категории

3\) Линейки

4\) Типоразмеры (CSV import)

5\) Документы (upload)

6\) Меню

7\) Новости (CSV import)

8\) Заявки (Leads)

9\) Редиректы (ручные правила)

10\) Настройки (в т.ч. Telegram)



\## 10. Редиректы (обязательно)

\- Системные редиректы `/catalog/...` -> `/...` включены всегда.

\- Ручные редиректы настраиваются в админке (таблица redirects).

\- Приоритет: ручные редиректы из БД выше системных.



\## 11. Telegram-бот (MVP)

\- /start

\- любые сообщения -> Lead

\- уведомления в чат

LLM/RAG — только заглушка (интерфейс подготовить, но без реализации).



\## 12. Импорт и инвентаризация URL

\- Предусмотреть CSV шаблоны для импорта категорий/линеек/типоразмеров/новостей/страниц.

\- Предусмотреть проверку старых URL из csv-инвентаризации: старый -> 301 -> новый -> 200.



\## 13. Приёмка

\- Все старые URL каталога 301 на новые.

\- sitemap.xml содержит только новые URL.

\- нет дублей из-за слеша/без слеша.

\- SEO поля доступны и редактируемы.

\- сайт запускается python app.py



