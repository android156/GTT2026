{% extends 'base.html' %}

{% block hero %}
<h1 class="visually-hidden">{{ seo.h1 }}</h1>
{% set hero_img = category.image_path or '/static/images/WhatsApp_Image_2019-10-21_at_13.44.44_1766758697538.jpeg' %}
<section class="hero page-hero" style="background-image: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('{{ hero_img }}');">
    <div class="container">
        <div class="hero-content">
            <div class="hero-main-title">{{ seo.h1 or category.name }}</div>
        </div>
    </div>
</section>
{% endblock %}

{% block content %}
<nav class="breadcrumbs">
    {% for crumb in breadcrumbs %}
    {% if crumb.url %}
    <a href="{{ crumb.url }}">{{ crumb.name }}</a> /
    {% else %}
    <span>{{ crumb.name }}</span>
    {% endif %}
    {% endfor %}
</nav>

{% if category.seo_description %}
<div class="category-short-desc">{{ category.seo_description }}</div>
{% endif %}

{% if product_lines %}
<div class="product-lines-grid">
    {% for pl in product_lines %}
    <a href="/{{ category.slug }}/{{ pl.slug }}/" class="product-line-card">
        {% set main_img_obj = pl.get_main_image_object() %}
        {% if main_img_obj %}
            {% if main_img_obj.no_watermark %}
        <img src="{{ main_img_obj.image_path }}" alt="{{ main_img_obj.alt or pl.name }}" class="product-line-img">
            {% else %}
        <img src="/wm/product_line/{{ main_img_obj.id }}/" alt="{{ main_img_obj.alt or pl.name }}" class="product-line-img">
            {% endif %}
        {% elif pl.image_path %}
        <img src="{{ pl.image_path }}" alt="{{ pl.name }}" class="product-line-img">
        {% else %}
        <div class="product-line-img placeholder"></div>
        {% endif %}
        <div class="product-line-info">
            <h3>{{ pl.hero_title if pl.hero_title else pl.name }}</h3>
            {% if pl.hero_subtitle %}
            <h5>{{ pl.hero_subtitle }}</h5>
            {% endif %}
        </div>
    </a>
    {% endfor %}
</div>
{% else %}
<p>Товары отсутствуют</p>
{% endif %}

{% if seo.seo_text %}
<div class="seo-text">{{ seo.seo_text|safe }}</div>
{% endif %}
{% endblock %}
