\# INSTR 06: Редиректы (системные + из БД)



\## Приоритет

1\) Ручные редиректы из RedirectRule (is\_active=true) — самый высокий приоритет.

2\) Системные редиректы для каталога: /catalog/... -> /...

3\) Редирект без завершающего слеша -> со слешем



\## Системные редиректы каталога

\- /catalog/<category>/ -> /<category>/

\- /catalog/<category>/<product>/ -> /<category>/<product>/

\- /catalog/<category>/<product>/<size>/ -> /<category>/<product>/<size>/



\## Админские правила

\- from\_path должен начинаться с / и заканчиваться /

\- to\_path должен начинаться с /

\- запрет циклов (A->B и B->A)

\- запрет from\_path совпадающего с реальным “живым” роутом (предупреждение или запрет)



\## Реализация

Лучше всего: before\_request hook, который проверяет:

\- сначала БД правила

\- потом системные

\- потом slash-normalization



