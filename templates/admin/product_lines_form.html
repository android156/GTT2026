{% extends 'admin/base.html' %}
{% block title %}{{ '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å' if product_line else '–î–æ–±–∞–≤–∏—Ç—å' }} –ª–∏–Ω–µ–π–∫—É{% endblock %}
{% block page_title %}{{ '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å' if product_line else '–î–æ–±–∞–≤–∏—Ç—å' }} –ª–∏–Ω–µ–π–∫—É{% endblock %}

{% block content %}
<div class="card">
    <form method="POST" enctype="multipart/form-data">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        
        <h3>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        <div class="form-group">
            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è <span class="required">*</span></label>
            <select name="category_id" required>
                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é --</option>
                {% for cat in categories %}
                <option value="{{ cat.id }}" {{ 'selected' if product_line and product_line.category_id == cat.id else '' }}>{{ cat.name }}</option>
                {% endfor %}
            </select>
            <small class="hint">–ö –∫–∞–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —ç—Ç–∞ –ª–∏–Ω–µ–π–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤</small>
        </div>
        <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ <span class="required">*</span></label>
            <input type="text" name="name" value="{{ product_line.name if product_line else '' }}" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ò–ó–û–ö–û–ú-–ê PE-Xa">
            <small class="hint">–ù–∞–∑–≤–∞–Ω–∏–µ –ª–∏–Ω–µ–π–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤</small>
        </div>
        <div class="form-group">
            <label>Slug <span class="required">*</span></label>
            <input type="text" name="slug" value="{{ product_line.slug if product_line else '' }}" required pattern="[a-z0-9_-]+" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: izokom-a-pe-xa">
            <small class="hint">–ß–∞—Å—Ç—å URL. –¢–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω–∏—Ü–∞, —Ü–∏—Ñ—Ä—ã, –¥–µ—Ñ–∏—Å. –ü—Ä–∏–º–µ—Ä: —Å–∞–π—Ç.—Ä—É/izokom/izokom-a-pe-xa/</small>
        </div>
        
        {% if product_line %}
        <hr>
        <h3>–ì–∞–ª–µ—Ä–µ—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</h3>
        <p class="section-desc">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏. –í—ã–±–µ—Ä–∏—Ç–µ –≥–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å–ø–∏—Å–∫–µ.</p>
        
        {% if product_line.images.count() > 0 %}
        <div class="gallery-manager">
            <div class="gallery-images">
                {% for img in product_line.images.order_by('sort_order').all() %}
                <div class="gallery-item {% if img.is_main %}is-main{% endif %}" data-id="{{ img.id }}">
                    <div class="gallery-img-wrap">
                        <img src="{{ img.image_path }}" alt="" style="transform: rotate({{ img.rotation or 0 }}deg);">
                    </div>
                    <div class="gallery-rotate">
                        <button type="button" class="btn-rotate" onclick="rotateImage({{ img.id }}, -90)" title="–ü–æ–≤–µ—Ä–Ω—É—Ç—å –≤–ª–µ–≤–æ">‚Ü∫</button>
                        <span class="rotation-deg">{{ img.rotation or 0 }}¬∞</span>
                        <button type="button" class="btn-rotate" onclick="rotateImage({{ img.id }}, 90)" title="–ü–æ–≤–µ—Ä–Ω—É—Ç—å –≤–ø—Ä–∞–≤–æ">‚Üª</button>
                    </div>
                    <div class="gallery-controls">
                        <button type="button" class="btn-edit-image" onclick="openImageEditModal({{ img.id }}, 'product_line')">SEO / –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</button>
                        <label title="–ì–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                            <input type="radio" name="main_image_id" value="{{ img.id }}" {% if img.is_main %}checked{% endif %}> –ì–ª–∞–≤–Ω–æ–µ
                        </label>
                        <label title="–£–¥–∞–ª–∏—Ç—å">
                            <input type="checkbox" name="delete_images[]" value="{{ img.id }}"> –£–¥–∞–ª–∏—Ç—å
                        </label>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        
        <div class="form-group">
            <label>–î–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –≥–∞–ª–µ—Ä–µ—é</label>
            <input type="file" name="gallery_images" multiple accept="image/*">
            <small class="hint">–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤</small>
        </div>
        
        <div class="form-group">
            <label>–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –≥–∞–ª–µ—Ä–µ–∏ (—Å–µ–∫)</label>
            <input type="number" name="gallery_interval" value="{{ product_line.gallery_interval if product_line else 5 }}" min="1" max="60" style="width: 100px;">
            <small class="hint">–°–∫–æ—Ä–æ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –≥–∞–ª–µ—Ä–µ–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ</small>
        </div>
        {% endif %}
        
        <hr>
        <h3>Hero-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h3>
        <p class="section-desc">–§–æ–Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —à–∞–ø–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ª–∏–Ω–µ–π–∫–∏</p>
        <div class="form-group">
            <label>URL Hero-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
            <input type="text" name="hero_image" value="{{ product_line.hero_image if product_line else '' }}" placeholder="/static/images/hero.jpg">
            <small class="hint">–ü—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é (–µ—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–ª–∞–≤–Ω–æ–µ –∏–∑ –≥–∞–ª–µ—Ä–µ–∏ –∏–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)</small>
        </div>
        <div class="form-group">
            <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤ Hero</label>
            <input type="text" name="hero_title" value="{{ product_line.hero_title if product_line else '' }}">
            <small class="hint">–ö—Ä—É–ø–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ–≤–µ—Ä—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏–Ω–µ–π–∫–∏)</small>
        </div>
        <div class="form-group">
            <label>–ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ Hero</label>
            <input type="text" name="hero_subtitle" value="{{ product_line.hero_subtitle if product_line else '' }}">
            <small class="hint">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç</small>
        </div>
        
        <hr>
        <h3>SEO –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
        <div class="form-group">
            <label>H1 –∑–∞–≥–æ–ª–æ–≤–æ–∫</label>
            <input type="text" name="h1" value="{{ product_line.h1 if product_line else '' }}" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¢—Ä—É–±–∞ –ò–ó–û–ö–û–ú-–ê PE-Xa">
            <small class="hint">–ì–ª–∞–≤–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (—Å–∫—Ä—ã—Ç—ã–π –¥–ª—è SEO)</small>
        </div>
        <div class="form-group">
            <label>SEO Title</label>
            <input type="text" name="seo_title" value="{{ product_line.seo_title if product_line else '' }}" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ò–ó–û–ö–û–ú-–ê PE-Xa ‚Äî –∫—É–ø–∏—Ç—å | –ì–ª–∞–≤–¢—Ä—É–±–¢–æ—Ä–≥">
            <small class="hint">–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø–æ–∏—Å–∫–æ–≤–∏–∫–æ–≤. 50-70 —Å–∏–º–≤–æ–ª–æ–≤</small>
        </div>
        <div class="form-group">
            <label>–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (seo_description)</label>
            <textarea name="seo_description" rows="2" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º...">{{ product_line.seo_description if product_line else '' }}</textarea>
            <small class="hint">–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –ø–æ–∏—Å–∫–∞ –∏ –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ. 150-160 —Å–∏–º–≤–æ–ª–æ–≤</small>
        </div>
        <div class="form-group">
            <label>SEO —Ç–µ–∫—Å—Ç (–≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã)</label>
            <div class="wysiwyg-toolbar" data-target="seo_text_html">
                <button type="button" onclick="formatText('seo_text_html', 'bold')" title="–ñ–∏—Ä–Ω—ã–π"><b>B</b></button>
                <button type="button" onclick="formatText('seo_text_html', 'italic')" title="–ö—É—Ä—Å–∏–≤"><i>I</i></button>
                <button type="button" onclick="formatText('seo_text_html', 'underline')" title="–ü–æ–¥—á—ë—Ä–∫–Ω—É—Ç—ã–π"><u>U</u></button>
                <span class="toolbar-sep"></span>
                <button type="button" onclick="insertTag('seo_text_html', 'h2')" title="–ó–∞–≥–æ–ª–æ–≤–æ–∫ H2">H2</button>
                <button type="button" onclick="insertTag('seo_text_html', 'h3')" title="–ó–∞–≥–æ–ª–æ–≤–æ–∫ H3">H3</button>
                <button type="button" onclick="insertTag('seo_text_html', 'p')" title="–ê–±–∑–∞—Ü">P</button>
                <button type="button" onclick="insertTag('seo_text_html', 'ul')" title="–°–ø–∏—Å–æ–∫">UL</button>
                <span class="toolbar-sep"></span>
                <button type="button" onclick="alignText('seo_text_html', 'left')" title="–ü–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é">‚¨±</button>
                <button type="button" onclick="alignText('seo_text_html', 'center')" title="–ü–æ —Ü–µ–Ω—Ç—Ä—É">‚¨å</button>
                <button type="button" onclick="alignText('seo_text_html', 'right')" title="–ü–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é">‚¨≤</button>
                <button type="button" onclick="alignText('seo_text_html', 'justify')" title="–ü–æ —à–∏—Ä–∏–Ω–µ">‚ò∞</button>
                <span class="toolbar-sep"></span>
                <button type="button" onclick="insertLink('seo_text_html')" title="–°—Å—ã–ª–∫–∞">üîó</button>
                <button type="button" onclick="insertTable('seo_text_html')" title="–¢–∞–±–ª–∏—Ü–∞">‚äû</button>
                <button type="button" onclick="toggleHtmlMode('seo_text_html')" title="HTML –∫–æ–¥">&lt;/&gt;</button>
            </div>
            <textarea name="seo_text_html" id="seo_text_html" rows="6" class="wysiwyg-textarea">{{ product_line.seo_text_html if product_line else '' }}</textarea>
            <small class="hint">–¢–µ–∫—Å—Ç –≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è SEO</small>
        </div>
        
        <hr>
        <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
        <div class="form-group">
            <label>–ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</label>
            <input type="number" name="sort_order" value="{{ product_line.sort_order if product_line else 0 }}" placeholder="0">
            <small class="hint">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é. 10, 20, 30...</small>
        </div>
        <div class="form-group form-check">
            <input type="checkbox" name="is_active" id="is_active" {{ 'checked' if product_line and product_line.is_active else 'checked' if not product_line else '' }}>
            <label for="is_active">–ê–∫—Ç–∏–≤–Ω–∞</label>
            <small class="hint">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –ª–∏–Ω–µ–π–∫–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ</small>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <a href="{{ url_for('admin.product_lines_list') }}" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
            {% if product_line %}
            <a href="{{ url_for('admin.accessory_blocks_list', pl_id=product_line.id) }}" class="btn btn-info" style="margin-left: auto;">–ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ</a>
            {% endif %}
        </div>
    </form>
</div>

<style>
.gallery-manager { margin-bottom: 20px; }
.gallery-images { display: flex; flex-wrap: wrap; gap: 15px; }
.gallery-item { 
    border: 2px solid #ddd; 
    border-radius: 8px; 
    padding: 10px; 
    background: #f9f9f9;
    width: 180px;
}
.gallery-item.is-main { border-color: #28a745; background: #e8f5e9; }
.gallery-img-wrap { 
    width: 100%; 
    height: 120px; 
    overflow: hidden; 
    border-radius: 4px; 
    display: flex; 
    align-items: center; 
    justify-content: center;
    background: #eee;
}
.gallery-item img { 
    max-width: 100%; 
    max-height: 120px; 
    object-fit: contain;
    transition: transform 0.3s;
}
.gallery-rotate {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-top: 8px;
    padding: 5px;
    background: #e9ecef;
    border-radius: 4px;
}
.btn-rotate {
    width: 28px;
    height: 28px;
    border: none;
    background: #fff;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
}
.btn-rotate:hover { background: #dee2e6; }
.rotation-deg { font-size: 11px; color: #666; min-width: 30px; text-align: center; }
.gallery-controls { margin-top: 8px; font-size: 12px; }
.gallery-controls label { display: block; margin: 5px 0; cursor: pointer; }
.btn-edit-image {
    padding: 4px 8px;
    font-size: 11px;
    background: #007bff;
    color: white;
    border: none;
    border-radius: 3px;
    cursor: pointer;
    margin-bottom: 5px;
    width: 100%;
}
.btn-edit-image:hover { background: #0056b3; }

.wysiwyg-toolbar {
    display: flex;
    gap: 4px;
    flex-wrap: wrap;
    margin-bottom: 5px;
    padding: 8px;
    background: #f5f5f5;
    border: 1px solid #ddd;
    border-bottom: none;
    border-radius: 4px 4px 0 0;
}
.wysiwyg-toolbar button {
    padding: 5px 10px;
    border: 1px solid #ccc;
    background: white;
    border-radius: 3px;
    cursor: pointer;
    font-size: 12px;
    min-width: 30px;
}
.wysiwyg-toolbar button:hover { background: #e9e9e9; }
.toolbar-sep {
    width: 1px;
    background: #ccc;
    margin: 0 4px;
    align-self: stretch;
}
.wysiwyg-textarea { 
    border-radius: 0 0 4px 4px !important; 
    font-family: monospace;
    width: 100%;
}
.wysiwyg-textarea.html-mode {
    font-family: 'Courier New', monospace;
    font-size: 13px;
    line-height: 1.4;
    background: #f8f8f8;
}
.btn-info {
    background: #17a2b8;
    color: white;
}
.btn-info:hover {
    background: #138496;
}
</style>

<script>
function formatText(textareaId, format) {
    const textarea = document.getElementById(textareaId);
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const selected = textarea.value.substring(start, end);
    
    let tag = '';
    switch(format) {
        case 'bold': tag = 'strong'; break;
        case 'italic': tag = 'em'; break;
        case 'underline': tag = 'u'; break;
    }
    
    const replacement = `<${tag}>${selected}</${tag}>`;
    textarea.value = textarea.value.substring(0, start) + replacement + textarea.value.substring(end);
    textarea.focus();
    textarea.setSelectionRange(start + tag.length + 2, start + tag.length + 2 + selected.length);
}

function insertTag(textareaId, tag) {
    const textarea = document.getElementById(textareaId);
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const selected = textarea.value.substring(start, end);
    
    let replacement;
    if (tag === 'ul') {
        const items = selected ? selected.split('\n').map(line => `  <li>${line}</li>`).join('\n') : '  <li></li>';
        replacement = `<ul>\n${items}\n</ul>`;
    } else {
        replacement = `<${tag}>${selected}</${tag}>`;
    }
    
    textarea.value = textarea.value.substring(0, start) + replacement + textarea.value.substring(end);
    textarea.focus();
}

function insertLink(textareaId) {
    const url = prompt('–í–≤–µ–¥–∏—Ç–µ URL:');
    if (!url) return;
    
    const textarea = document.getElementById(textareaId);
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const selected = textarea.value.substring(start, end) || '–¢–µ–∫—Å—Ç —Å—Å—ã–ª–∫–∏';
    
    const replacement = `<a href="${url}">${selected}</a>`;
    textarea.value = textarea.value.substring(0, start) + replacement + textarea.value.substring(end);
    textarea.focus();
}

function alignText(textareaId, alignment) {
    const textarea = document.getElementById(textareaId);
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const selected = textarea.value.substring(start, end);
    
    const replacement = `<p style="text-align: ${alignment};">${selected}</p>`;
    textarea.value = textarea.value.substring(0, start) + replacement + textarea.value.substring(end);
    textarea.focus();
}

function insertTable(textareaId) {
    const rows = prompt('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫:', '3');
    if (!rows) return;
    const cols = prompt('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤:', '3');
    if (!cols) return;
    
    const numRows = parseInt(rows) || 3;
    const numCols = parseInt(cols) || 3;
    
    let table = '<table class="content-table">\n';
    table += '  <thead>\n    <tr>\n';
    for (let c = 0; c < numCols; c++) {
        table += `      <th>–ó–∞–≥–æ–ª–æ–≤–æ–∫ ${c + 1}</th>\n`;
    }
    table += '    </tr>\n  </thead>\n  <tbody>\n';
    for (let r = 0; r < numRows - 1; r++) {
        table += '    <tr>\n';
        for (let c = 0; c < numCols; c++) {
            table += '      <td></td>\n';
        }
        table += '    </tr>\n';
    }
    table += '  </tbody>\n</table>';
    
    const textarea = document.getElementById(textareaId);
    const pos = textarea.selectionStart;
    textarea.value = textarea.value.substring(0, pos) + table + textarea.value.substring(pos);
    textarea.focus();
}

function toggleHtmlMode(textareaId) {
    const textarea = document.getElementById(textareaId);
    textarea.classList.toggle('html-mode');
    
    if (textarea.classList.contains('html-mode')) {
        const formatted = textarea.value
            .replace(/></g, '>\n<')
            .replace(/\n\n+/g, '\n');
        textarea.value = formatted;
    }
}

{% if product_line %}
function rotateImage(imageId, degrees) {
    fetch(`{{ url_for('admin.rotate_product_line_image', image_id=0) }}`.replace('0', imageId), {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token() }}'
        },
        body: JSON.stringify({ degrees: degrees })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            const item = document.querySelector(`.gallery-item[data-id="${imageId}"]`);
            const img = item.querySelector('img');
            const degSpan = item.querySelector('.rotation-deg');
            img.style.transform = `rotate(${data.rotation}deg)`;
            degSpan.textContent = data.rotation + '¬∞';
        } else {
            alert('–û—à–∏–±–∫–∞: ' + data.error);
        }
    })
    .catch(err => alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏'));
}
{% endif %}
</script>

{% if product_line %}
{% include 'admin/includes/image_edit_modal.html' %}
{% endif %}
{% endblock %}
