{% extends 'base.html' %}

{% block hero %}
<h1 class="visually-hidden">{{ seo.h1 }}</h1>
{% if hero %}
<section class="hero page-hero" style="background-image: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('{{ hero.image }}');">
    <div class="container">
        <div class="hero-content">
            <div class="hero-main-title">{{ hero.title }}</div>
            {% if hero.subtitle %}<p class="hero-desc">{{ hero.subtitle }}</p>{% endif %}
        </div>
    </div>
</section>
{% endif %}
{% endblock %}

{% block content %}
<nav class="breadcrumbs">
    {% for crumb in breadcrumbs %}
    {% if crumb.url %}
    <a href="{{ crumb.url }}">{{ crumb.name }}</a> /
    {% else %}
    <span>{{ crumb.name }}</span>
    {% endif %}
    {% endfor %}
</nav>

<div class="page-content">
    {{ page.content_html|safe }}
    
    {% if page.url_path == '/contacts/' %}
    <div id="map" style="width: 100%; height: 450px; margin-top: 30px; border: 1px solid var(--border-color);"></div>
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
    <script>
        ymaps.ready(function () {
            var myMap = new ymaps.Map("map", {
                center: [55.899786, 37.552003], // Координаты центра (Москва, Лианозовский проезд, 6)
                zoom: 16
            });

            var myPlacemark = new ymaps.Placemark(myMap.getCenter(), {
                hintContent: 'Группа ГЛАВТРУБТОРГ',
                balloonContent: '127253, Москва, Лианозовский проезд, дом 6'
            });

            myMap.geoObjects.add(myPlacemark);
        });
    </script>
    {% endif %}
    {% if page.url_path == 'contacts' or page.url_path == '/contacts/' %}
    <section class="service-cta-section" id="callback" style="margin-top: 60px;">
        <div class="cta-content">
            <div class="cta-info">
                <h3>Остались вопросы?</h3>
                <p>Оставьте заявку, и наш специалист свяжется с вами в течение 15 минут.</p>
            </div>
        </div>
        <div class="cta-form-wrapper">
            <form action="{{ url_for('public.submit_lead') }}" method="POST" class="lead-form service-lead-form" id="contacts-lead-form">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <input type="hidden" name="message" value="Заявка со страницы контактов">
                <input type="hidden" name="page_url" value="{{ request.url }}">
                <input type="hidden" name="utm_source" value="">
                <input type="hidden" name="utm_medium" value="">
                <input type="hidden" name="utm_campaign" value="">
                <input type="hidden" name="utm_term" value="">
                <input type="hidden" name="utm_content" value="">
                <input type="hidden" name="captcha_token" id="contacts-captcha-token" value="">
                <div style="display:none !important;"><input type="text" name="website" tabindex="-1" autocomplete="off"></div>
                <div class="form-row">
                    <input type="text" name="name" placeholder="Ваше имя" required>
                </div>
                <div class="form-row">
                    <input type="tel" name="phone" placeholder="Телефон" required>
                </div>
                <div class="form-row">
                    <input type="email" name="email" placeholder="Email">
                </div>
                <div class="form-row captcha-row">
                    <label id="contacts-captcha-question">Загрузка...</label>
                    <input type="number" name="captcha_answer" placeholder="Ответ" required>
                </div>
                <button type="submit" class="btn btn-primary">Отправить заявку</button>
            </form>
        </div>
    </section>
    {% endif %}
</div>

{% if seo.seo_text %}
<div class="seo-text">{{ seo.seo_text|safe }}</div>
{% endif %}
{% endblock %}
